(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t){},28:function(e,t,a){"use strict";var n=a(11),r=a(12),i=a(14),c=a(13),o=a(15),l=a(1),s=a.n(l),m=a(5),u=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).myCanvasRef=s.a.createRef(),a.thumbWidth=80,a.thumbHeight=80,a.canvasOnClick=a.props.onClick,a.imageDetails=a.props.faces,a.compareSource=a.props.compareSrc,a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.imageDetails,t=this.myCanvasRef.current,a=t.getContext("2d"),n=Object(m.b)(this.thumbWidth,e.width,e.height),r=n.width,i=n.height;t.width=r,t.height=i,a.drawImage(this.props.origSrc,e.x,e.y,e.width,e.height,0,0,r,i)}},{key:"render",value:function(){var e=this.imageDetails,t=e.description,a=e.rank,n=e.similarity;return void 0===this.compareSource?s.a.createElement("div",{className:"col"},s.a.createElement("canvas",{className:"dropzone-image-preview rounded-circle",ref:this.myCanvasRef,onClick:this.canvasOnClick})):s.a.createElement("tr",null,s.a.createElement("td",{align:"left"},s.a.createElement("b",null,"# ",a)),s.a.createElement("td",{align:"left"},s.a.createElement("canvas",{className:"dropzone-image-preview rounded-circle",ref:this.myCanvasRef,onClick:this.canvasOnClick})),s.a.createElement("td",{align:"left"},s.a.createElement("span",{"data-toggle":"tooltip",title:"Similarity score: "+n+"%"},t)))}}]),t}(s.a.Component);t.a=u},411:function(e,t,a){},413:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(52),c=a.n(i),o=(a(60),a(11)),l=a(12),s=a(14),m=a(13),u=a(15),d=a(53),p=(a(411),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("hr",null),r.a.createElement("h2",null,r.a.createElement("b",null,"Wanna gauge your likeness with someone?")),r.a.createElement("h3",null,"Upload a photo here and the person you wanna checkout!"),r.a.createElement("h4",null,"No worries, you can load photos with multiple faces."),r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(d.a,null))),r.a.createElement("hr",null),r.a.createElement("p",{style:{fontSize:"10px"}},r.a.createElement("em",null,"Disclaimer: This demo is for fun only. No images are stored. Amazon Rekognition face comparison is a stateless API operation. That is, data returned by this operation doesn't persist.  ")),r.a.createElement("hr",null))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},5:function(e,t,a){"use strict";function n(e,t,a){if(e&&e.length>0){var n=e[0],r=n.type;return n.size>t?(console.log("Image file is too big!"),!1):!!a.includes(r)||(console.log("Only image file is accepted."),!1)}}function r(e,t,a){return t>a?t>e&&(a*=e/t,t=e):a>e&&(t*=e/a,a=e),{width:t,height:a}}function i(e){switch(!0){case e>=90:return"Hey! This is the same person!";case e<90&&e>=70:return"Whoah! You got your doppelganger!";case e<70&&e>=50:return"Oh, looks like a close relative!";case e<50&&e>=30:return"Yay! There's a slight resemblance!";default:return"Almost but not quite. ;) Try again!"}}function c(e){return new Promise(function(t,a){var n=new Image;n.src=e,n.addEventListener("load",function(){return t(n)}),n.addEventListener("error",a)})}a.d(t,"d",function(){return n}),a.d(t,"b",function(){return r}),a.d(t,"a",function(){return i}),a.d(t,"c",function(){return c})},53:function(e,t,a){"use strict";(function(e){var n=a(6),r=a.n(n),i=a(18),c=a(11),o=a(12),l=a(14),s=a(13),m=a(15),u=a(1),d=a.n(u),p=a(27),h=a.n(p),g=a(29),f=a(16),v=a.n(f),E=a(5),S=a(28);v.a.config.region="ap-southeast-1",v.a.config.credentials=new v.a.CognitoIdentityCredentials({IdentityPoolId:"ap-southeast-1:3a603ae9-22c6-428a-930c-44cb5ad18299"});var w=10485760,b=["image/x-png","image/png","image/jpg","image/jpeg","image/gif"],y=250,k=function(e){var t=e.title,a=e.note;return d.a.createElement("div",null,d.a.createElement("h1",null,t),d.a.createElement("p",{className:"dropzone-paragraph"},a))},C=function(e){var t=e.onClick;return d.a.createElement("div",{className:"w-100 alert alert-danger",role:"alert"},d.a.createElement("b",null,"Multiple Faces Detected"),d.a.createElement("br",null),d.a.createElement("em",null,"Choose one to select or ",d.a.createElement("span",{className:"span-btn",onClick:t},"click here")," to upload a new one instead:"))},O=function(e){var t=e.onClick;return d.a.createElement("div",{className:"w-100 alert alert-info",role:"alert"},d.a.createElement("b",null,"Similarity score ranking is displayed below!"),d.a.createElement("br",null),d.a.createElement("em",null,"Having fun? ",d.a.createElement("span",{className:"span-btn",onClick:t},"Click here")," to retry!"))},N=function(){return d.a.createElement("div",{className:"w-100 alert alert-success",role:"alert"},d.a.createElement("b",null,"Great!")," Now proceed to Step 2 and upload the next photo.")},j=function(e){var t=e.result,a=e.src,n=e.compareSrc,r=e.onClick;return d.a.createElement("div",null,d.a.createElement(O,{onClick:r}),d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col"}),d.a.createElement("div",{className:"col-md-6"},d.a.createElement("table",{cellPadding:"5",cellSpacing:"5",border:"0",width:"100%"},d.a.createElement("tbody",null,t.map(function(e,t){return d.a.createElement(S.a,{faces:e,origSrc:a[1],compareSrc:n,key:t})})))),d.a.createElement("div",{className:"col"})))},D=function(t){function a(t){var n;return Object(c.a)(this,a),(n=Object(l.a)(this,Object(s.a)(a).call(this,t))).handleOnDropForstep1Image=function(e,t){t&&t.length>0&&(Object(E.d)(t,w,b)||alert("Please check image size (<10mb) or file type (image)."));n.onDrop(e,"step1Image")},n.handleOnDropForParentImage=function(e,t){t&&t.length>0&&(Object(E.d)(t,w,b)||alert("Please check image size (<10mb) or file type (image)."));n.onDrop(e,"parentImage")},n.onDrop=function(){var e=Object(i.a)(r.a.mark(function e(t,a){var c,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.length>0&&(Object(E.d)(t,w,b)?(c=t[0],o=new FileReader,"step1Image"===a?n.setState({imgStep1LoadStatus:"loading"}):n.setState({imgStep2LoadStatus:"loading"}),o.addEventListener("load",Object(i.a)(r.a.mark(function e(){var t,i,c,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.result,e.next=3,Object(E.c)(t);case 3:i=e.sent,c=[t.split(",")[1],i],"step1Image"===a?(n.setState({imgStep1:c}),n.detectFaces(i,a)):(n.setState({imgStep2:c}),l=n.state.compareSource,n.compareFaces(l,c[0]));case 6:case"end":return e.stop()}},e,this)})),!1),o.readAsDataURL(c)):alert("Please check image size (<10mb) or file type (image)."));case 1:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),n.detectFaces=function(){var t=Object(i.a)(r.a.mark(function t(a,i){var c,o,l,s,m;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=a.src,o=c.split(",")[1],l=new v.a.Rekognition,s=l.detectFaces({Image:{Bytes:e.from(o,"base64")},Attributes:["ALL"]}).promise(),t.next=6,s;case 6:void 0!==(m=t.sent).FaceDetails&&0!==m.FaceDetails.length?n.updateStep1Canvas(a,m.FaceDetails,i):(alert("No face detected, please re-upload a new image."),"step1Image"===i?n.setState({imgStep1:[]}):n.setState({imgStep2:[]}));case 8:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}(),n.compareFaces=function(){var t=Object(i.a)(r.a.mark(function t(a,i){var c,o,l,s,m,u,d,p,h,g,f,S,w,b,y,k,C;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c={SimilarityThreshold:10,SourceImage:{Bytes:e.from(a,"base64")},TargetImage:{Bytes:e.from(i,"base64")}},o=new v.a.Rekognition,l=o.compareFaces(c).promise(),t.next=5,l;case 5:if(void 0!==(s=t.sent).FaceMatches&&0!==s.FaceMatches.length){for(m=s.FaceMatches,u=n.state.imgStep2,d=m.length,p=0,h=[],p=0;p<d;p++)g=m[p].Face.BoundingBox,f=Math.round(100*m[p].Similarity)/100,S=n.calculateBoundingLines(g,u[1]),w=S.x,b=S.y,y=S.width,k=S.height,C=Object(E.a)(f),h[p]={x:w,y:b,width:y,height:k,similarity:f,rank:p+1,description:C};n.setState({compareResult:h})}case 7:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}(),n.clearToDefault=function(e){e&&e.preventDefault(),n.setState(n.initialState)},n.onThumbClick=function(e){var t=n.state.imgStep1,a=n.imgStep1CanvasRef.current,r=a.getContext("2d"),i=Object(E.b)(y,e.width,e.height),c=i.width,o=i.height;a.width=c+10,a.height=o+10,r.drawImage(t[1],e.x,e.y,e.width,e.height,5,5,c,o);var l=a.toDataURL();n.setState({compareSource:l.split(",")[1]})},n.imgStep1CanvasRef=d.a.createRef(),n.imgStep2CanvasRef=d.a.createRef(),n.state={imgStep1:[],imgStep2:[],imgStep1LoadStatus:"not loaded",imgStep2LoadStatus:"not loaded",imgStep1FaceDetails:[],compareSource:null,compareResult:[]},n}return Object(m.a)(a,t),Object(o.a)(a,[{key:"componentWillMount",value:function(){this.initialState=this.state}},{key:"calculateBoundingLines",value:function(e,t){var a=t.naturalWidth,n=t.naturalHeight;return{x:e.Left*a,y:e.Top*n,width:e.Width*a,height:e.Height*n}}},{key:"updateStep1Canvas",value:function(e,t,a){var n=t.length,r=this.state.imgStep1,i=r[1];this.setState({imgStep1LoadStatus:"loaded"}),1===n&&this.setState({compareSource:r[0]});var c=this.imgStep1CanvasRef.current,o=c.getContext("2d"),l=e.naturalWidth,s=e.naturalHeight,m=Object(E.b)(y,l,s),u=m.width,d=m.height;e.width=u,e.height=d,c.width=u,c.height=d,o.drawImage(e,0,0,l,s,0,0,u,d);var p=0,h=[];for(p=0;p<n;p++){var g=t[p].BoundingBox,f=t[p].AgeRange,v=this.calculateBoundingLines(g,i),S=v.x,w=v.y,b=v.width,k=v.height;h[p]={x:S,y:w,width:b,height:k,age:f}}this.setState({imgStep1FaceDetails:h})}},{key:"render",value:function(){var e=this,t=this.state,a=t.imgStep1,n=t.imgStep1LoadStatus,r=t.imgStep2,i=t.imgStep2LoadStatus,c=t.imgStep1FaceDetails,o=t.compareSource,l=t.compareResult;return d.a.createElement("div",{className:"container"},l.length>0&&r.length>0?d.a.createElement(j,{result:l,src:r,compareSrc:o,onClick:this.clearToDefault}):d.a.createElement("div",null,d.a.createElement("div",{className:"row",style:{padding:"20px"}},d.a.createElement("div",{className:"col-md-6"},null!==o?d.a.createElement(N,null):null,"not loaded"===n?d.a.createElement(g.a,{onDrop:this.handleOnDropForstep1Image,accept:"image/*",maxSize:w,multiple:!1},function(e){var t=e.getRootProps,a=e.getInputProps,n=e.isDragActive;return d.a.createElement("div",Object.assign({},t(),{className:h()("dropzone",{"dropzone--isActive":n})}),d.a.createElement("input",a()),d.a.createElement(k,{title:"Step 1",note:n?"Drag and drop the source photo here...":"Use your own image.  Upload or drag and drop. Your image isn't stored."}))}):d.a.createElement("div",{align:"center"},"loading"===n?d.a.createElement("div",{className:"loader"}):d.a.createElement("canvas",{className:"dropzone-image-preview",ref:this.imgStep1CanvasRef}))),null!==o?d.a.createElement("div",{className:"col"},"not loaded"===i?d.a.createElement(g.a,{onDrop:this.handleOnDropForParentImage,accept:"image/*",maxSize:w,multiple:!1},function(e){var t=e.getRootProps,a=e.getInputProps,n=e.isDragActive;return d.a.createElement("div",Object.assign({},t(),{className:h()("dropzone",{"dropzone--isActive":n})}),d.a.createElement("input",a()),d.a.createElement(k,{title:"Step 2",note:n?"Drag and drop the second photo here...":"Use your own image.  Upload or drag and drop. Your image isn't stored."}))}):d.a.createElement("div",{align:"center"},"loading"===i?d.a.createElement("div",{className:"loader"}):d.a.createElement("canvas",{className:"dropzone-image-preview",ref:this.imgStep2CanvasRef}))):null),d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-md-6"},d.a.createElement("div",{className:"row"},c.length>1?d.a.createElement(C,{onClick:this.clearToDefault}):null,c.length>1&&a.length>0?c.map(function(t,n){return d.a.createElement(S.a,{faces:t,origSrc:a[1],onClick:function(){return e.onThumbClick(t)},key:n})}):d.a.createElement("div",{className:"col"}))))))}}]),a}(d.a.Component);t.a=D}).call(this,a(8).Buffer)},55:function(e,t,a){e.exports=a(413)},60:function(e,t,a){}},[[55,2,1]]]);
//# sourceMappingURL=main.70c00ffd.chunk.js.map